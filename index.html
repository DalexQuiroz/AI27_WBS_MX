<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI27</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="img/logo.png">
</head>
<body>
    <div class="header">
      <div class="barra contenedor">
        <a href="index.html"><img src="img/logo.png" alt="logo" class="barra__imagen"></a>
        <h1 class="barra__texto">Integración AI27</h1>
      </div>
    </div>

    <main class="contenedor sombra">
        <div class="header__form">
            <h3 class="title">Registro de eventos de seguridad</h3>
            <div class="header__consultar">
                <label type="number" for="ingresar_id" class="campo__label" id="informacionInput">Ingrese el id:</label>
                <input type="number" id="ingresar_id" class="campo__input" placeholder="Id de la unidad">
                <button type="button" id="traer" class="header__form__boton">Consultar</button>
                <button class="header__form__boton limpiar" onclick="limpiarFormulario()">Limpiar</button>
            </div>
        </div>
        <form action="" class="formulario" id="form">
            <div class="campo">
                <label for="ecoNumber" class="campo__label">Economico Unidad</label>
                <input type="text" class="campo__input"  id="ecoNumber" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="plates" class="campo__label">Placas</label>
                <input type="text" class="campo__input"  id="plates" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="generatedEvent" class="campo__label">Evento Generado</label>
                <input type="number" class="campo__input"  id="generatedEvent" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="generatedEventDate" class="campo__label">Fecha Evento</label>
                <input type="text" class="campo__input"  id="generatedEventDate" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="latitude" class="campo__label">Latitud</label>
                <input type="text" class="campo__input"  id="latitude" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="longitude" class="campo__label">Longitud</label>
                <input type="text" class="campo__input"  id="longitude" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="speed" class="campo__label">Velocidad</label>
                <input type="text" class="campo__input"  id="speed" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="odometer" class="campo__label">Odometro</label>
                <input type="text" class="campo__input"  id="odometer" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="battery" class="campo__label">Bateria</label>
                <input type="text" class="campo__input"  id="battery" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="customerId" class="campo__label">Customer id</label>
                <input type="number" class="campo__input"  id="customerId" placeholder="Ingrese el id" required>
            </div>
            <div class="campo">
                <label for="transportLineId" class="campo__label">Id línea de transporte</label>
                <input type="text" class="campo__input"  id="transportLineId" placeholder="Ingrese el id" required>
            </div>

            

            
        
            <div class="enviar">
                <input class="enviar__input" id="Enviar" value="Enviar formulario">
            </div>
          
        </form>
    </main>
</body>
<script">
    let datos = {}; // Declarar datos fuera de las funciones
/*const datos2 = {
  customerId: 333,
  transportLineId: 15522,
  ecoNumber: "ECO4528",
  plates: "ABC-123",
  generatedEvent: "1",
  generatedEventDate: "2023-11-01 12:24:15",
  latitude: 99.02312542,
  longitude: 0.9956325,
  speed: 85,
  heading: 259.36225,
  odometer: 652300,
  battery: 12.5
};*/

// Llamada a traer cuando se presiona el primer botón
document.getElementById('traer').addEventListener('click', traer);
function traer() {
  let informacionInput = document.getElementById('ingresar_id').value;
  let valorNumerico = parseInt(informacionInput, 10);

  fetch(`https://ws.fulltrack2.com/events/single/id/${valorNumerico}/apiKey/2de1558ef0b75457df254383eecbf0400b1362b7/secretKey/6ef96e3ad7d2e6e3293426c6f11bbb8e3ac493aa`)
    .then(res => res.json())
    .then(res => {
      console.log(res);
      for (let i = 0; i < res.data.length; i++) {
        const element = res.data[i];
        document.getElementById('ecoNumber').value = element.ras_vei_veiculo;
        document.getElementById('plates').value = element.ras_vei_placa;
        document.getElementById('generatedEventDate').value = element.ras_eve_data_enviado;
        document.getElementById('latitude').value = element.ras_eve_latitude;
        document.getElementById('longitude').value = element.ras_eve_longitude;
        document.getElementById('speed').value = element.ras_eve_velocidade;
        document.getElementById('odometer').value = element.ras_eve_hodometro;
        document.getElementById('battery').value = element.ras_eve_voltagem;
      }

      // Almacena los datos en la variable
      const customerId = document.getElementById('customerId').value;
      const transportLineId = document.getElementById('transportLineId').value;
      const ecoNumber = document.getElementById('ecoNumber').value;
      const plates = document.getElementById('plates').value;
      const generatedEvent = document.getElementById('generatedEvent').value;
      const generatedEventDate = document.getElementById('generatedEventDate').value;
      const latitude = document.getElementById('latitude').value;
      const longitude = document.getElementById('longitude').value;
      const speed = document.getElementById('speed').value;
      const odometer = document.getElementById('odometer').value;
      const battery = document.getElementById('battery').value;

      // Datos por el usuario
  

      // Actualiza la variable datos con la información recopilada
      datos = {
        customerId: customerId,
        transportLineId: transportLineId,
        ecoNumber: ecoNumber,
        plates: plates,
        generatedEvent: generatedEvent,
        generatedEventDate: generatedEventDate,
        latitude: latitude,
        longitude: longitude,
        speed: speed,
        odometer: odometer,
        battery: battery
      };

      console.log(datos);
    })
}
// Llamada a enviarDataAI27 cuando se presiona el segundo botón
document.getElementById('Enviar').addEventListener('click', enviarDataAI27);
function enviarDataAI27() {
  const urlAI27 = 'https://api.ai27appsservices.com/AI27WebApi';// Reemplaza con la URL correcta
  const headers = {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer eyJraWQiOiJUdjhreEsycTZJMWhra0ZWUk90eTFvNXZJdmZndEt1TU9UdU01MWh3YWdRPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI0Y3ZrdG50Njdrbm41NTh2aWpjbW1zdXQ2dSIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoid3NhdXRoaWRlbnRpZmllclwvd3Muc2NvcGUiLCJhdXRoX3RpbWUiOjE3MDE3MjI0MzYsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbVwvdXMtZWFzdC0xX210RUhESk9uaSIsImV4cCI6MTcwMTcyNjAzNiwiaWF0IjoxNzAxNzIyNDM2LCJ2ZXJzaW9uIjoyLCJqdGkiOiI1ZDEwOWRlYS03NjVlLTQzZTMtYjA2Yi00ZjM0MjcwOWE4MDciLCJjbGllbnRfaWQiOiI0Y3ZrdG50Njdrbm41NTh2aWpjbW1zdXQ2dSJ9.jAg89M6jHbqYs_gxe67Ef0fZeuZXsigLvtrrmtdjkFON4dZqa9rrEuFYKSn4BLMw8braC-XAUroiCDN4ai1HtIDdksXvh6y27ZSLLK-4BHiYDcmuJwJB-c0JHr0JLEpwA_vJ9-uvIzC4c-RJQU7CfgdxScZ_rB4fsNlRE7hJlaIAYpL24TRWj_DtA_l7JazRfIRCz8TEmW0AwRuxJUg1GzQAw1GRcLa3lpqKGUJKnqlZ2-YV82IjxFrS-FocBeEemAVD7HXhPTAhgDdCYuSuJeq226tFtA4Zdh2ldsLZe5S2T_jQVxicYSGNTRMYj4tEOF1eeEDhtvHN6SFoqsqwlQ'
    };

  const opciones = {
    method: 'POST',
    headers: headers,
    body: JSON.stringify(datos) // Utiliza los datos recopilados
  };

  fetch(urlAI27, opciones)
    .then(respuesta => respuesta.json())
    .then(respuesta => {
      console.log('Respuesta del servidor AI27:', respuesta);
    })
    .catch(error => {
      console.error('Error al enviar la solicitud a AI27:', error);
    });
}
</script>
</html>
